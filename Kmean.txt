# ---- Import Required Libraries ----
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler
from sklearn.datasets import load_iris
from sklearn.metrics import silhouette_score

# ---- Step 1: Load the Iris Dataset ----
iris = load_iris()
data = pd.DataFrame(iris.data, columns=iris.feature_names)

# ---- Step 2: Standardize the Data ----
scaler = StandardScaler()
scaled_data = scaler.fit_transform(data)

# ---- Step 3: Apply K-Means Clustering ----
kmeans = KMeans(n_clusters=3, random_state=42)
kmeans.fit(scaled_data)

# Store cluster labels
data['Cluster'] = kmeans.labels_

# ---- Step 4: Evaluate Clustering ----
silhouette = silhouette_score(scaled_data, kmeans.labels_)
print(f"Silhouette Score: {silhouette:.3f}")

# ---- Step 5: Visualization ----
plt.scatter(data.iloc[:, 0], data.iloc[:, 1], c=data['Cluster'], cmap='rainbow')
plt.title("K-Means Clustering on Iris Dataset")
plt.xlabel("Sepal Length (scaled)")
plt.ylabel("Sepal Width (scaled)")
plt.grid(True)
plt.show()
